my_ip : 10.10.0.12, my_id : 2
updateinterval: 200
[info]>>>origin msg is 0101010281FB7B1F984197397E9D5A85AD979E23000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000
[info]>>>recive msg 
index : 1
srcid : 1
destid : 2
nonce : 81FB7B1F984197397E9D5A85AD979E23
hmac : 0000000000000000000000000000000000000000000000000000000000000000
##########CASE ONE DEBUG INFO START##########
[info]>>the mbuf of hmac is 0102CFDD0A79C98CD05B5A9F114EF6C7E56C81FB7B1F984197397E9D5A85AD979E23
[info]>>>will send msg 
index : 2
srcid : 2
destid : 1
nonce : CFDD0A79C98CD05B5A9F114EF6C7E56C
hmac : C19A7DE058AF6F3441BE125ECFDACF4375BE4547AA164FF4CC0691F30A36E88F
##########CASE ONE DEBUG INFO END##########
[info]>>>origin msg is 0103010200000000000000000000000000000000C19A7DE058AF6F3441BE125ECFDACF4375BE4547AA164FF4CC0691F30A36E88F00000000001000000000000000
[info]>>>recive msg 
index : 3
srcid : 1
destid : 2
nonce : 00000000000000000000000000000000
hmac : C19A7DE058AF6F3441BE125ECFDACF4375BE4547AA164FF4CC0691F30A36E88F
##########CASE THREE DEBUG INFO START##########
[info]>>> hmac right
end_time: 2329
drone-1 auth success!
-----------------encrypt---------------
plaintext: 81FB7B1F984197397E9D5A85AD979E23CFDD0A79C98CD05B5A9F114EF6C7E56C
key: 5634703C834DF7F5F74833F580C5CD9A
iv: 30313233343536373839616263646500
ciphertext: 6C16FD827C27CB024D94C7AE5C4A957B217777E45DE5D36D60899A50026618DF
[info]>>>will send auth msg: 
index : 4
srcid : 2
destid : 1
nonce : 00000000000000000000000000000000
hmac : 6C16FD827C27CB024D94C7AE5C4A957B217777E45DE5D36D60899A50026618DF
[info]>> auth table 
| id         | Authed     | Direct     | nonce1                           | nonce2                           | sessionkey                       |
| 1          | True       || True       |81FB7B1F984197397E9D5A85AD979E23  |CFDD0A79C98CD05B5A9F114EF6C7E56C  |5634703C834DF7F5F74833F580C5CD9A  |

1
123
##########CASE THREE DEBUG INFO END##########
mynonce is: 65F94D7894A5BD518BDB0E6F7F5EF229
start_time: 2921
Send Auth msg to drone-0!
====================menu====================
0:Print Auth Table
1:Authenticate	 2:Update Session Key	 3:xxxxxx
-----------------decrypt---------------
ciphertext: 603EF194BD031EBF9DB13B85AF88C31CADD6478B4F6C633E8229E9A66F6FFED0
key: 5634703C834DF7F5F74833F580C5CD9A
iv: 30313233343536373839616263646500
Update_msg:
src_id : 1
dest_id: 2
newnonce: 073424019C4E4402DE808DCE09B67932
-----------------encrypt---------------
plaintext: 02010287E1CB5A8920B90096453A5D8721E99300000000001000000000000000
key: 5634703C834DF7F5F74833F580C5CD9A
iv: 30313233343536373839616263646500
ciphertext: 8A8DCBE228CFFE5F5B29C1AEE12DF0DCDDEC1195FB67AAFCDB7680BC55845EBA
send response update msg to drone-1
response_msg:
src_id : 2
dest_id: 1
newnonce: 87E1CB5A8920B90096453A5D8721E993
drone-1 update success
new session key is B6506B20C41817F6C55770D5FB7EA9AD
-----------------decrypt---------------
ciphertext: 44B50111193FB5254AE83E0A8003804A3F443B7348F8FEF9F4F61536157B88E422D134EC1E17DC86694545705A226F53
key: B6506B20C41817F6C55770D5FB7EA9AD
iv: 30313233343536373839616263646500
Update_Share_msg:
num: 1
id: 02
nonce: 87E1CB5A8920B90096453A5D8721E993
Update 1 drones
Auth table
| id         | Authed     | Direct     | nonce1                           | nonce2                           | sessionkey                       |
| 1          | True       || True       |073424019C4E4402DE808DCE09B67932  |87E1CB5A8920B90096453A5D8721E993  |B6506B20C41817F6C55770D5FB7EA9AD  |

update times: 1
sum: 197
update id: 2
-----------------encrypt---------------
plaintext: 0201017FE1C6549240BDB18B34201248E3849D00000000001000000000000000
key: B6506B20C41817F6C55770D5FB7EA9AD
iv: 30313233343536373839616263646500
ciphertext: CC3F335C3876886A01B9D36674112792CB389D5C47B92A84F06187D0591BAA1F
Resend update msg to drone-1
-----------------encrypt---------------
plaintext: 0201010000000000000000000000000000000000000000001000000000000000
key: B6506B20C41817F6C55770D5FB7EA9AD
iv: 30313233343536373839616263646500
ciphertext: 861064588662F843D1F37569DD5FE173061BEB62AE405369FD9DEDE3FE43BBAC
send update msg to drone-1 success
Resend update msg to drone-1
-----------------encrypt---------------
plaintext: 0201010000000000000000000000000000000000000000001000000000000000
key: B6506B20C41817F6C55770D5FB7EA9AD
iv: 30313233343536373839616263646500
ciphertext: 861064588662F843D1F37569DD5FE173061BEB62AE405369FD9DEDE3FE43BBAC
send update msg to drone-1 success
Resend update msg to drone-1
-----------------encrypt---------------
plaintext: 0201010000000000000000000000000000000000000000001000000000000000
key: B6506B20C41817F6C55770D5FB7EA9AD
iv: 30313233343536373839616263646500
ciphertext: 861064588662F843D1F37569DD5FE173061BEB62AE405369FD9DEDE3FE43BBAC
send update msg to drone-1 success
drone-1 lost!
